#N canvas 580 96 528 427 10;
#X declare -path ../../generic_abstractions;
#X declare -path ../generic_abstractions -path ./module_instances;
#X obj 19 266 *~;
#X obj 19 309 +~;
#X obj 65 228 pack f 20;
#X obj 65 250 line~;
#X obj 188 227 * -1;
#X obj 188 249 + 1;
#X obj 188 271 pack f 20;
#X obj 188 293 line~;
#X obj 292 202 switch~;
#X obj 19 381 throw~;
#X obj 53 347 route 0;
#X obj 292 157 r \$0-1st_outlet;
#X obj 53 325 set_outputs \$4 \$5;
#N canvas 8 51 559 699 assemble_and_scale_values 0;
#X obj 22 140 +;
#X obj 39 119 * 128;
#X obj 57 90 +;
#X obj 74 69 * 128;
#X obj 92 140 +;
#X obj 109 119 * 128;
#X obj 127 90 +;
#X obj 144 69 * 128;
#X obj 162 140 +;
#X obj 179 119 * 128;
#X obj 197 90 +;
#X obj 214 69 * 128;
#X obj 232 158 +;
#X obj 249 137 * 128;
#X obj 22 572 /;
#X obj 92 467 / 8191;
#X obj 92 489 * 2;
#X obj 127 413 / 8191;
#X obj 162 367 / 8191;
#X obj 197 273 / 8191;
#X obj 197 295 pow 4;
#X obj 197 317 * 1000;
#X obj 232 181 / 8191;
#X obj 232 203 pow 4;
#X obj 232 225 * 1000;
#X obj 57 533 debounce_float 10;
#X obj 57 555 + 1;
#X obj 92 511 s \$0-2nd_knob;
#X obj 22 660 s \$0-1st_knob;
#X obj 127 435 s \$0-3rd_knob;
#X obj 162 389 s \$0-4th_knob;
#X obj 197 339 s \$0-5th_knob;
#X obj 232 247 s \$0-6th_knob;
#X obj 22 36 unpack f f f f f f f f f f f f f f f f;
#X obj 267 91 +;
#X obj 285 69 * 128;
#N canvas 162 119 808 504 other-values 0;
#X obj 38 54 r to_mtx_mul;
#X obj 38 76 list split 1;
#X obj 78 121 unpack f f f;
#X obj 78 143 == \$5;
#X obj 120 228 spigot;
#X obj 100 199 f;
#X obj 78 165 sel 1;
#X msg 120 250 \$1-incoming_freq;
#X obj 120 272 symbol;
#X obj 102 297 s;
#X text 113 338 send this oscillator's value to any oscillator module
it gives input to \, for the reason stated in the comment above;
#X obj 78 98 t l l;
#X obj 238 115 unpack f f f;
#X obj 238 137 == \$5;
#X obj 280 239 spigot;
#X obj 260 193 f;
#X obj 238 159 sel 1;
#X obj 280 283 symbol;
#X obj 262 308 s;
#X msg 280 261 \$1-incoming_amp_freq;
#X obj 350 134 \$3;
#X obj 350 112 r \$1-get_inlet;
#X obj 12 177 inlet;
#X obj 12 199 t f f;
#N canvas 586 169 595 399 check-inlet-num 0;
#X obj 59 72 loadbang;
#X obj 59 94 v num_of_modules;
#X obj 41 117 f;
#X obj 73 162 tabread all_inlets_tab;
#X obj 73 295 f;
#X obj 41 48 t b f;
#X obj 41 25 inlet;
#X obj 73 250 sel 1;
#X obj 73 272 t b b;
#X obj 73 317 outlet;
#X text 101 225 find which module this inlet belongs to;
#X text 100 288 and use the number of that module's first inlet \,
because [receive] is not flexible enough in naming it;
#X obj 73 206 f;
#X obj 73 184 t b f f;
#X obj 73 228 >=;
#X obj 41 139 loop, f 5;
#X connect 0 0 1 0;
#X connect 1 0 2 1;
#X connect 2 0 15 0;
#X connect 3 0 13 0;
#X connect 4 0 9 0;
#X connect 5 0 2 0;
#X connect 5 1 12 1;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 8 0 4 0;
#X connect 8 1 15 3;
#X connect 12 0 14 0;
#X connect 13 0 12 0;
#X connect 13 1 14 1;
#X connect 13 2 4 1;
#X connect 14 0 7 0;
#X connect 15 1 3 0;
#X restore 260 214 pd check-inlet-num;
#X obj 350 156 s give_inlet;
#X text 349 66 store the first inlet number to a global table to use
it in the [pd check-inlet-num] subpatch (explanation in the subpatch)
;
#X connect 0 0 1 0;
#X connect 1 1 11 0;
#X connect 2 0 3 0;
#X connect 2 1 5 1;
#X connect 2 2 4 1;
#X connect 3 0 6 0;
#X connect 4 0 7 0;
#X connect 5 0 4 0;
#X connect 6 0 5 0;
#X connect 7 0 8 0;
#X connect 8 0 9 1;
#X connect 11 0 2 0;
#X connect 11 1 12 0;
#X connect 12 0 13 0;
#X connect 12 1 15 1;
#X connect 12 2 14 1;
#X connect 13 0 16 0;
#X connect 14 0 19 0;
#X connect 15 0 24 0;
#X connect 16 0 15 0;
#X connect 17 0 18 1;
#X connect 19 0 17 0;
#X connect 20 0 25 0;
#X connect 21 0 20 0;
#X connect 22 0 23 0;
#X connect 23 0 9 0;
#X connect 23 1 18 0;
#X connect 24 0 14 0;
#X restore 45 639 pd other-values;
#N canvas 0 51 653 357 num_of_voices 0;
#X obj 18 96 / 8191;
#X obj 18 160 i;
#X obj 18 181 change;
#X obj 18 286 array size \$0-frequencies;
#X obj 38 265 array size \$0-amplitudes;
#X obj 78 223 s \$0-num_voices;
#X obj 18 117 * 29;
#X obj 18 138 + 1;
#X obj 58 244 array size \$0-midi_amps;
#X obj 18 202 t f f f f;
#X obj 91 202 r \$0-resize_arrays;
#X obj 79 16 r \$0-1st_inlet;
#X obj 117 39 r \$0-midi_connect;
#X obj 79 56 >>;
#X obj 18 51 inlet;
#X obj 18 73 spigot;
#X text 111 58 if a signal connects to the frequency inlet \, but that's
not the midi module \, then and only then use the first knob to set
the number of voices;
#X connect 0 0 6 0;
#X connect 1 0 2 0;
#X connect 2 0 9 0;
#X connect 6 0 7 0;
#X connect 7 0 1 0;
#X connect 9 0 3 0;
#X connect 9 1 4 0;
#X connect 9 2 8 0;
#X connect 9 3 5 0;
#X connect 10 0 9 0;
#X connect 11 0 13 0;
#X connect 12 0 13 1;
#X connect 13 0 15 1;
#X connect 14 0 15 0;
#X connect 15 0 0 0;
#X restore 68 617 pd num_of_voices;
#X obj 267 113 s \$0-ramp_time;
#X obj 22 594 t f f f;
#X obj 22 13 r module\$1;
#X connect 0 0 14 0;
#X connect 1 0 0 1;
#X connect 2 0 25 0;
#X connect 3 0 2 1;
#X connect 4 0 15 0;
#X connect 5 0 4 1;
#X connect 6 0 17 0;
#X connect 7 0 6 1;
#X connect 8 0 18 0;
#X connect 9 0 8 1;
#X connect 10 0 19 0;
#X connect 11 0 10 1;
#X connect 12 0 22 0;
#X connect 13 0 12 1;
#X connect 14 0 39 0;
#X connect 15 0 16 0;
#X connect 16 0 27 0;
#X connect 17 0 29 0;
#X connect 18 0 30 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 21 0 31 0;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 24 0 32 0;
#X connect 25 0 26 0;
#X connect 26 0 14 1;
#X connect 33 0 0 0;
#X connect 33 1 1 0;
#X connect 33 2 2 0;
#X connect 33 3 3 0;
#X connect 33 4 4 0;
#X connect 33 5 5 0;
#X connect 33 6 6 0;
#X connect 33 7 7 0;
#X connect 33 8 8 0;
#X connect 33 9 9 0;
#X connect 33 10 10 0;
#X connect 33 11 11 0;
#X connect 33 12 12 0;
#X connect 33 13 13 0;
#X connect 33 14 34 0;
#X connect 33 15 35 0;
#X connect 34 0 38 0;
#X connect 35 0 34 1;
#X connect 39 0 28 0;
#X connect 39 1 36 0;
#X connect 39 2 37 0;
#X connect 40 0 33 0;
#X restore 19 49 pd assemble_and_scale_values;
#X obj 19 125 catch~ \$0-sum;
#N canvas 159 69 767 639 initialize_instances 0;
#X obj 59 14 loadbang;
#X msg 59 37 1;
#N canvas 366 184 450 300 \$0-instances 0;
#X obj 30 30 var_shapes_instance 1020 0;
#X restore 111 266 pd \$0-instances;
#X obj 111 134 t f f;
#X obj 111 156 * 30;
#X obj 111 178 + 30;
#X msg 219 156 clear;
#X obj 178 156 \$0;
#X obj 111 200 pack f f f;
#X obj 11 290 r to_mtx_mul;
#X obj 11 312 list split 1;
#X obj 51 334 unpack f f f;
#X obj 51 406 == \$3;
#X obj 91 383 ==;
#X obj 51 428 &&;
#X obj 79 584 s \$0-midi_connect;
#X obj 79 516 f;
#X text 88 37 create one instance of this module by default;
#X obj 111 245 s pd-\$0-instances;
#X obj 109 360 r midi_outlet;
#X obj 59 134 outlet;
#X msg 111 223 obj 30 \$1 var_shapes_instance \$3 \$2 \, loadbang;
#X obj 51 472 f;
#X obj 51 450 sel 1;
#X text 111 508 when many instances are created bang the midi connection
state so it's sent to all instances;
#X obj 297 311 r num_of_midi_voices;
#X obj 279 333 f;
#X obj 111 561 sel 1;
#X obj 51 494 t f f f;
#X obj 79 538 t f f;
#X obj 59 89 t b f b b;
#X obj 75 61 r \$0-num_voices;
#X text 280 116 if this module connects to the midi module \, the number
of instances set by the midi module will be used \, otherwise \, we'll
use the number of instances set by this module;
#X obj 279 355 t f f;
#X obj 311 377 s \$0-resize_arrays;
#X obj 79 111 loop, f 5;
#X obj 51 383 - 1;
#X connect 0 0 1 0;
#X connect 1 0 30 0;
#X connect 3 0 4 0;
#X connect 3 1 8 1;
#X connect 4 0 5 0;
#X connect 5 0 8 0;
#X connect 6 0 18 0;
#X connect 7 0 8 2;
#X connect 8 0 21 0;
#X connect 9 0 10 0;
#X connect 10 1 11 0;
#X connect 11 0 36 0;
#X connect 11 1 13 0;
#X connect 11 2 22 1;
#X connect 12 0 14 0;
#X connect 13 0 14 1;
#X connect 14 0 23 0;
#X connect 16 0 29 0;
#X connect 19 0 13 1;
#X connect 21 0 18 0;
#X connect 22 0 28 0;
#X connect 23 0 22 0;
#X connect 25 0 26 1;
#X connect 26 0 33 0;
#X connect 27 0 26 0;
#X connect 28 0 15 0;
#X connect 28 1 27 0;
#X connect 28 2 16 1;
#X connect 29 0 15 0;
#X connect 29 1 27 0;
#X connect 30 0 20 0;
#X connect 30 1 35 0;
#X connect 30 2 7 0;
#X connect 30 3 6 0;
#X connect 31 0 30 0;
#X connect 33 0 35 0;
#X connect 33 1 34 0;
#X connect 35 0 16 0;
#X connect 35 1 3 0;
#X connect 36 0 12 0;
#X restore 19 71 pd initialize_instances;
#X obj 19 173 *~;
#X obj 19 11 declare -path ../generic_abstractions -path ./module_instances
;
#X text 191 71 we're forcing the order of bangs here;
#N canvas 79 171 378 240 \$0-switches 0;
#X obj 21 15 r switches;
#X obj 21 37 route \$1;
#X obj 45 157 s \$0-new_freq;
#X obj 21 185 outlet;
#X obj 21 59 route 1 2 3;
#X obj 45 135 sel 1;
#X obj 70 85 sel 1;
#X obj 70 107 s \$0-new_amp;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 4 0 3 0;
#X connect 4 1 5 0;
#X connect 4 2 6 0;
#X connect 5 0 2 0;
#X connect 6 0 7 0;
#X restore 65 180 pd \$0-switches;
#N canvas 216 65 777 587 names_states_and_tab_init 0;
#X obj 27 233 s \$0-1st_input;
#X obj 45 213 s \$0-2nd_input;
#X obj 64 193 s \$0-3rd_input;
#X obj 82 173 s \$0-4th_input;
#X obj 101 153 s \$0-5th_input;
#X obj 119 133 s \$0-6th_input;
#X obj 27 286 r inlet_states;
#X obj 27 308 unpack;
#X obj 27 352 pack;
#X text 148 66 this sets the correct names to each [r~ ];
#X text 26 255 this sets the connection state of the modules inlets
(the matrix's outlets);
#X obj 307 388 unpack;
#X obj 307 432 pack;
#X obj 307 476 s \$0-1st_outlet;
#X text 306 335 this sets the connection state of the modules outlets
(the matrix's inlets);
#X obj 307 366 r outlet_states;
#X obj 27 66 set_inputs \$2 \$3;
#X obj 27 330 - \$3;
#X obj 307 410 - \$5;
#X obj 307 454 route 1;
#X obj 27 19 inlet;
#X obj 138 113 s \$0-7th_input;
#X obj 27 374 route 1 2 3 4 5 6 7;
#X obj 27 89 route 0 1 2 3 4 5 6;
#X obj 509 146 array size \$0-frequencies;
#X obj 532 124 array size \$0-amplitudes;
#X msg 509 58 1;
#X obj 509 80 t f f f;
#X obj 555 102 array size \$0-midi_amps;
#N canvas 0 51 396 278 \$0-inlet1 0;
#X obj 49 50 inlet;
#X obj 49 122 inlet_state;
#X obj 86 75 r reactivate;
#X obj 123 100 r patchUpdate;
#X obj 49 204 s \$0-1st_inlet;
#X msg 137 145 0;
#X text 170 146 start off with no connection;
#X obj 137 123 inlet;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 5 0 4 0;
#X connect 7 0 5 0;
#X restore 27 558 pd \$0-inlet1;
#N canvas 0 51 450 300 \$0-inlet2 0;
#X obj 31 29 inlet;
#X obj 31 101 inlet_state;
#X obj 68 54 r reactivate;
#X obj 105 79 r patchUpdate;
#X msg 119 124 0;
#X text 152 125 start off with no connection;
#X obj 31 183 s \$0-2nd_inlet;
#X obj 119 102 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 4 0 6 0;
#X connect 7 0 4 0;
#X restore 45 538 pd \$0-inlet2;
#N canvas 0 51 450 300 \$0-inlet3 0;
#X obj 54 27 inlet;
#X obj 54 99 inlet_state;
#X obj 91 52 r reactivate;
#X obj 128 77 r patchUpdate;
#X msg 141 121 0;
#X text 174 122 start off with no connection;
#X obj 54 181 s \$0-3rd_inlet;
#X obj 141 99 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 4 0 6 0;
#X connect 7 0 4 0;
#X restore 64 518 pd \$0-inlet3;
#N canvas 0 51 450 300 \$0-inlet4 0;
#X obj 32 31 inlet;
#X obj 32 103 inlet_state;
#X obj 69 56 r reactivate;
#X obj 106 81 r patchUpdate;
#X msg 117 125 0;
#X text 150 126 start off with no connection;
#X obj 32 185 s \$0-4th_inlet;
#X obj 117 103 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 4 0 6 0;
#X connect 7 0 4 0;
#X restore 82 498 pd \$0-inlet4;
#N canvas 0 51 450 300 \$0-inlet5 0;
#X obj 30 22 inlet;
#X obj 30 94 inlet_state;
#X obj 67 47 r reactivate;
#X obj 104 72 r patchUpdate;
#X msg 117 116 0;
#X text 150 117 start off with no connection;
#X obj 30 176 s \$0-5th_inlet;
#X obj 117 94 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 4 0 6 0;
#X connect 7 0 4 0;
#X restore 101 478 pd \$0-inlet5;
#N canvas 0 51 450 300 \$0-inlet6 0;
#X obj 30 21 inlet;
#X obj 30 93 inlet_state;
#X obj 67 46 r reactivate;
#X obj 104 71 r patchUpdate;
#X msg 116 116 0;
#X text 149 117 start off with no connection;
#X obj 30 175 s \$0-6th_inlet;
#X obj 116 94 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 4 0 6 0;
#X connect 7 0 4 0;
#X restore 119 458 pd \$0-inlet6;
#N canvas 0 51 450 300 \$0-inlet7 0;
#X obj 19 31 inlet;
#X obj 19 103 inlet_state;
#X obj 56 56 r reactivate;
#X obj 93 81 r patchUpdate;
#X msg 106 125 0;
#X text 139 126 start off with no connection;
#X obj 19 185 s \$0-7th_inlet;
#X obj 106 103 inlet;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 4 0 6 0;
#X connect 7 0 4 0;
#X restore 138 438 pd \$0-inlet7;
#X obj 27 41 t b b b;
#X obj 117 401 t b b b b b b b;
#X connect 6 0 7 0;
#X connect 7 0 17 0;
#X connect 7 1 8 1;
#X connect 8 0 22 0;
#X connect 11 0 18 0;
#X connect 11 1 12 1;
#X connect 12 0 19 0;
#X connect 15 0 11 0;
#X connect 16 0 23 0;
#X connect 17 0 8 0;
#X connect 18 0 12 0;
#X connect 19 0 13 0;
#X connect 20 0 36 0;
#X connect 22 0 29 0;
#X connect 22 1 30 0;
#X connect 22 2 31 0;
#X connect 22 3 32 0;
#X connect 22 4 33 0;
#X connect 22 5 34 0;
#X connect 22 6 35 0;
#X connect 23 0 0 0;
#X connect 23 1 1 0;
#X connect 23 2 2 0;
#X connect 23 3 3 0;
#X connect 23 4 4 0;
#X connect 23 5 5 0;
#X connect 23 6 21 0;
#X connect 26 0 27 0;
#X connect 27 0 24 0;
#X connect 27 1 25 0;
#X connect 27 2 28 0;
#X connect 36 0 16 0;
#X connect 36 1 37 0;
#X connect 36 2 26 0;
#X connect 37 0 29 1;
#X connect 37 1 30 1;
#X connect 37 2 31 1;
#X connect 37 3 32 1;
#X connect 37 4 33 1;
#X connect 37 5 34 1;
#X connect 37 6 35 1;
#X restore 19 93 pd names_states_and_tab_init;
#N canvas 165 51 814 670 \$0-scale_output 0;
#X obj 349 120 r midi_event;
#X obj 349 163 f;
#X obj 199 531 pow -1;
#X obj 199 561 pack f 15;
#X obj 199 583 line~;
#X obj 199 605 outlet~;
#X obj 58 19 r \$0-midi_connect;
#X obj 58 41 t f f;
#X obj 349 142 spigot;
#X obj 58 63 == 0;
#X obj 19 120 r \$0-new_amp;
#X obj 19 142 spigot;
#X obj 19 281 t f b;
#X obj 44 375 +;
#X obj 74 376 f;
#X msg 62 353 0;
#X obj 44 326 tabread \$0-amplitudes;
#X obj 19 186 t f f;
#X obj 51 209 > 1;
#X obj 51 231 t f f;
#X obj 19 256 spigot;
#X obj 83 256 sel 0;
#X msg 83 278 1;
#X text 80 296 if only one instace \, multiply by 1;
#X text 184 15 check if this module is connected to the midi module
and choose amplitude table accordingly;
#X obj 19 164 f;
#X obj 193 103 r \$0-num_voices;
#X obj 349 281 t f b;
#X obj 374 375 +;
#X obj 404 376 f;
#X msg 392 353 0;
#X obj 349 186 t f f;
#X obj 381 209 > 1;
#X obj 381 231 t f f;
#X obj 349 256 spigot;
#X obj 413 256 sel 0;
#X msg 413 278 1;
#X obj 374 326 tabread \$0-midi_amps;
#X obj 193 125 t f f;
#X obj 19 303 loop;
#X obj 349 303 loop;
#X obj 318 438 r \$0-7th_inlet;
#X obj 318 460 t f f;
#X obj 257 515 spigot;
#X obj 199 508 spigot;
#X obj 264 491 t f f;
#X obj 350 482 sel 0;
#X msg 350 504 1;
#X text 361 461 if nothing is connected to the amp inlet \, use full
amplitude;
#X connect 0 0 8 0;
#X connect 1 0 31 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 6 0 7 0;
#X connect 7 0 9 0;
#X connect 7 1 8 1;
#X connect 8 0 1 0;
#X connect 9 0 11 1;
#X connect 10 0 11 0;
#X connect 11 0 25 0;
#X connect 12 0 39 0;
#X connect 12 1 15 0;
#X connect 13 0 14 0;
#X connect 13 0 44 0;
#X connect 14 0 13 1;
#X connect 15 0 13 1;
#X connect 16 0 13 0;
#X connect 17 0 20 0;
#X connect 17 1 18 0;
#X connect 18 0 19 0;
#X connect 19 0 20 1;
#X connect 19 1 21 0;
#X connect 20 0 12 0;
#X connect 21 0 22 0;
#X connect 22 0 43 0;
#X connect 25 0 17 0;
#X connect 26 0 38 0;
#X connect 27 0 40 0;
#X connect 27 1 30 0;
#X connect 28 0 29 0;
#X connect 28 0 44 0;
#X connect 29 0 28 1;
#X connect 30 0 28 1;
#X connect 31 0 34 0;
#X connect 31 1 32 0;
#X connect 32 0 33 0;
#X connect 33 0 34 1;
#X connect 33 1 35 0;
#X connect 34 0 27 0;
#X connect 35 0 36 0;
#X connect 36 0 43 0;
#X connect 37 0 28 0;
#X connect 38 0 25 1;
#X connect 38 1 1 1;
#X connect 39 1 16 0;
#X connect 40 1 37 0;
#X connect 41 0 42 0;
#X connect 42 0 45 0;
#X connect 42 1 46 0;
#X connect 43 0 3 0;
#X connect 44 0 2 0;
#X connect 45 0 44 1;
#X connect 45 1 43 1;
#X connect 46 0 47 0;
#X connect 47 0 3 0;
#X restore 37 151 pd \$0-scale_output;
#N canvas 191 550 289 156 \$0-tables 0;
#X obj 20 10 table \$0-freq_wave 512;
#X obj 20 30 table \$0-frequencies;
#X obj 20 50 table \$0-amp_wave 512;
#X obj 20 70 table \$0-amplitudes;
#X obj 20 91 table \$0-midi_amps;
#X restore 292 292 pd \$0-tables;
#N canvas 411 81 732 566 \$0-write_amp_values 0;
#X obj 42 444 f;
#X msg 60 422 0;
#X obj 61 185 samplerate~;
#X obj 17 224 swap;
#X obj 17 246 /;
#X obj 72 444 +;
#X obj 17 311 /;
#X obj 17 202 f;
#X obj 17 78 t b b;
#X text 140 71 write the incoming signal to a table;
#X text 56 237 then calculate how many sample one period takes;
#X obj 42 398 t b f;
#X obj 17 355 f;
#X obj 17 333 t b f b;
#X obj 61 162 loadbang;
#X text 76 307 and calculate index jump according the the number of
voices \, to read and store values from the stored signal \, to the
amplitudes table;
#X obj 17 117 del;
#X obj 61 207 t f f;
#X obj 253 178 /;
#X obj 253 200 * 1000;
#X text 305 175 set array's size in ms to delay the rest of the process
after we store a wave to the table;
#X obj 89 95 tabwrite~ \$0-amp_wave;
#X obj 253 156 array size \$0-amp_wave;
#X obj 253 133 t f f;
#X obj 17 10 r \$0-new_amp;
#X obj 35 268 r \$0-num_voices;
#X obj 42 466 tabread \$0-amp_wave;
#X obj 42 492 tabwrite \$0-amplitudes;
#X obj 89 68 r~;
#X obj 89 46 r \$0-7th_input;
#N canvas 604 166 450 300 check_num_voices 0;
#X obj 71 32 inlet;
#X obj 149 31 inlet;
#X obj 131 106 f;
#X text 159 104 number of voices;
#X obj 131 128 > 1;
#X obj 131 150 s \$0-amp_tab_or_knob;
#X connect 0 0 2 0;
#X connect 1 0 2 1;
#X connect 2 0 4 0;
#X connect 4 0 5 0;
#X restore 17 516 pd check_num_voices;
#X obj 35 290 t f f f;
#X obj 35 140 r \$3-incoming_amp_freq;
#X obj 17 377 loop;
#X connect 0 0 5 0;
#X connect 0 0 26 0;
#X connect 1 0 0 1;
#X connect 2 0 17 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 6 0;
#X connect 5 0 0 1;
#X connect 6 0 13 0;
#X connect 7 0 3 0;
#X connect 8 0 16 0;
#X connect 8 1 21 0;
#X connect 11 0 0 0;
#X connect 11 1 27 1;
#X connect 12 0 33 0;
#X connect 13 0 12 0;
#X connect 13 1 5 1;
#X connect 13 2 1 0;
#X connect 14 0 2 0;
#X connect 16 0 7 0;
#X connect 17 0 3 1;
#X connect 17 1 23 0;
#X connect 18 0 19 0;
#X connect 19 0 16 1;
#X connect 22 0 18 0;
#X connect 23 0 22 0;
#X connect 23 1 18 1;
#X connect 24 0 8 0;
#X connect 25 0 31 0;
#X connect 26 0 27 0;
#X connect 28 0 21 0;
#X connect 29 0 28 0;
#X connect 31 0 6 1;
#X connect 31 1 12 1;
#X connect 31 2 30 1;
#X connect 32 0 7 1;
#X connect 33 0 30 0;
#X connect 33 1 11 0;
#X restore 292 270 pd \$0-write_amp_values;
#N canvas 83 117 740 566 \$0-write_freq_values 0;
#X obj 52 442 f;
#X msg 70 420 0;
#X obj 71 183 samplerate~;
#X obj 27 222 swap;
#X obj 27 244 /;
#X obj 82 442 +;
#X obj 27 309 /;
#X obj 27 200 f;
#X obj 27 76 t b b;
#X text 150 69 write the incoming signal to a table;
#X text 66 235 then calculate how many sample one period takes;
#X obj 52 396 t b f;
#X obj 27 353 f;
#X obj 27 331 t b f b;
#X obj 265 176 /;
#X obj 265 198 * 1000;
#X text 317 173 set array's size in ms to delay the rest of the process
after we store a wave to the table;
#X obj 27 111 del;
#X obj 71 160 loadbang;
#X obj 71 205 t f f;
#X text 86 305 and calculate index jump according the the number of
voices \, to read and store values of a full period from the stored
signal \, to the frequencies table;
#X obj 99 93 tabwrite~ \$0-freq_wave;
#X obj 265 154 array size \$0-freq_wave;
#X obj 52 464 tabread \$0-freq_wave;
#X obj 52 490 tabwrite \$0-frequencies;
#X obj 27 18 r \$0-new_freq;
#X obj 45 266 r \$0-num_voices;
#X obj 99 66 r~;
#X obj 99 43 r \$0-1st_input;
#N canvas 506 136 450 300 check_num_voices 0;
#X obj 71 32 inlet;
#X obj 149 31 inlet;
#X obj 131 106 f;
#X text 159 104 number of voices;
#X obj 131 128 > 1;
#X obj 131 150 s \$0-freq_tab_or_knob;
#X connect 0 0 2 0;
#X connect 1 0 2 1;
#X connect 2 0 4 0;
#X connect 4 0 5 0;
#X restore 27 514 pd check_num_voices;
#X obj 45 288 t f f f;
#X obj 265 132 t b f;
#X obj 45 135 r \$3-incoming_freq;
#X obj 27 375 loop;
#X connect 0 0 5 0;
#X connect 0 0 23 0;
#X connect 1 0 0 1;
#X connect 2 0 19 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 6 0;
#X connect 5 0 0 1;
#X connect 6 0 13 0;
#X connect 7 0 3 0;
#X connect 8 0 17 0;
#X connect 8 1 21 0;
#X connect 11 0 0 0;
#X connect 11 1 24 1;
#X connect 12 0 33 0;
#X connect 13 0 12 0;
#X connect 13 1 5 1;
#X connect 13 2 1 0;
#X connect 14 0 15 0;
#X connect 15 0 17 1;
#X connect 17 0 7 0;
#X connect 18 0 2 0;
#X connect 19 0 3 1;
#X connect 19 1 31 0;
#X connect 22 0 14 0;
#X connect 23 0 24 0;
#X connect 25 0 8 0;
#X connect 26 0 30 0;
#X connect 27 0 21 0;
#X connect 28 0 27 0;
#X connect 30 0 6 1;
#X connect 30 1 12 1;
#X connect 30 2 29 1;
#X connect 31 0 22 0;
#X connect 31 1 14 1;
#X connect 32 0 7 1;
#X connect 33 0 29 0;
#X connect 33 1 11 0;
#X restore 292 247 pd \$0-write_freq_values;
#N canvas 706 229 321 182 \$0-collect-midi-amps 0;
#X obj 36 27 r midi-amps;
#X obj 36 73 spigot;
#X obj 36 95 unpack;
#X obj 36 127 tabwrite \$0-midi_amps;
#X obj 75 51 r \$0-midi_connect;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 4 0 1 1;
#X restore 292 224 pd \$0-collect-midi-amps;
#N canvas 635 139 527 458 \$0-scale-offset 0;
#X obj 36 61 change;
#X obj 36 273 + 1;
#X obj 36 297 swap 1;
#X obj 36 319 /;
#X obj 36 341 t f f;
#X obj 54 222 loadbang;
#X msg 54 244 0;
#X obj 36 385 outlet;
#X obj 68 364 outlet;
#X obj 36 86 swap;
#X obj 36 108 pack;
#X obj 36 130 route 1 0;
#X obj 36 197 f;
#X text 65 184 when the patching update is deactivated \, store value
and output it when it is reactivated;
#X obj 221 69 r patchUpdate;
#X obj 109 130 r reactivate;
#X obj 36 39 inlet;
#X connect 0 0 9 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 3 0 4 0;
#X connect 4 0 7 0;
#X connect 4 1 8 0;
#X connect 5 0 6 0;
#X connect 6 0 1 0;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 1 0;
#X connect 14 0 9 1;
#X connect 15 0 12 0;
#X connect 16 0 0 0;
#X restore 65 204 pd \$0-scale-offset;
#X obj 292 180 switch_state \$0;
#X connect 0 0 1 0;
#X connect 1 0 9 0;
#X connect 2 0 3 0;
#X connect 3 0 0 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 1 1;
#X connect 10 0 9 0;
#X connect 11 0 27 0;
#X connect 12 0 10 0;
#X connect 14 0 16 0;
#X connect 15 0 20 0;
#X connect 16 0 0 0;
#X connect 19 0 26 0;
#X connect 21 0 16 1;
#X connect 26 0 2 0;
#X connect 26 1 4 0;
#X connect 27 0 8 0;
