#N canvas 373 61 628 435 10;
#X declare -path ../generic_abstractions -path ./module_instances;
#X obj 19 266 *~;
#X obj 19 309 +~;
#X obj 65 228 pack f 20;
#X obj 65 250 line~;
#X obj 188 227 * -1;
#X obj 188 249 + 1;
#X obj 188 271 pack f 20;
#X obj 188 293 line~;
#X obj 282 202 switch~;
#X obj 19 381 throw~;
#X obj 53 347 route 0;
#X obj 282 157 r \$0-1st_outlet;
#X obj 53 325 set_outputs \$4 \$5;
#X obj 19 125 catch~ \$0-sum;
#X obj 19 173 *~;
#X obj 19 11 declare -path ../generic_abstractions -path ./module_instances
;
#X text 221 71 we're forcing the order of bangs here;
#N canvas 76 169 378 240 \$0-switches 0;
#X obj 21 15 r switches;
#X obj 21 37 route \$1;
#X obj 45 157 s \$0-new_freq;
#X obj 21 185 outlet;
#X obj 21 59 route 1 2 3;
#X obj 45 135 sel 1;
#X obj 70 85 sel 1;
#X obj 70 107 s \$0-new_amp;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 4 0 3 0;
#X connect 4 1 5 0;
#X connect 4 2 6 0;
#X connect 5 0 2 0;
#X connect 6 0 7 0;
#X restore 65 180 pd \$0-switches;
#N canvas 159 51 814 670 \$0-scale_output 0;
#X obj 349 120 r midi_event;
#X obj 349 163 f;
#X obj 199 531 pow -1;
#X obj 199 561 pack f 15;
#X obj 199 583 line~;
#X obj 199 605 outlet~;
#X obj 58 19 r \$0-midi_connect;
#X obj 58 41 t f f;
#X obj 349 142 spigot;
#X obj 58 63 == 0;
#X obj 19 142 spigot;
#X obj 19 281 t f b;
#X obj 44 375 +;
#X obj 74 376 f;
#X msg 62 353 0;
#X obj 44 326 tabread \$0-amplitudes;
#X obj 19 186 t f f;
#X obj 51 209 > 1;
#X obj 51 231 t f f;
#X obj 19 256 spigot;
#X obj 83 256 sel 0;
#X msg 83 278 1;
#X text 80 296 if only one instace \, multiply by 1;
#X text 184 15 check if this module is connected to the midi module
and choose amplitude table accordingly;
#X obj 19 164 f;
#X obj 193 103 r \$0-num_voices;
#X obj 349 281 t f b;
#X obj 374 375 +;
#X obj 404 376 f;
#X msg 392 353 0;
#X obj 349 186 t f f;
#X obj 381 209 > 1;
#X obj 381 231 t f f;
#X obj 349 256 spigot;
#X obj 413 256 sel 0;
#X msg 413 278 1;
#X obj 374 326 tabread \$0-midi_amps;
#X obj 193 125 t f f;
#X obj 19 303 loop;
#X obj 349 303 loop;
#X obj 318 438 r \$0-7th_inlet;
#X obj 318 460 t f f;
#X obj 257 515 spigot;
#X obj 199 508 spigot;
#X obj 264 491 t f f;
#X obj 350 482 sel 0;
#X msg 350 504 1;
#X text 361 461 if nothing is connected to the amp inlet \, use full
amplitude;
#X obj 19 120 r \$0-set_new_amp;
#X connect 0 0 8 0;
#X connect 1 0 30 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 6 0 7 0;
#X connect 7 0 9 0;
#X connect 7 1 8 1;
#X connect 8 0 1 0;
#X connect 9 0 10 1;
#X connect 10 0 24 0;
#X connect 11 0 38 0;
#X connect 11 1 14 0;
#X connect 12 0 13 0;
#X connect 12 0 43 0;
#X connect 13 0 12 1;
#X connect 14 0 12 1;
#X connect 15 0 12 0;
#X connect 16 0 19 0;
#X connect 16 1 17 0;
#X connect 17 0 18 0;
#X connect 18 0 19 1;
#X connect 18 1 20 0;
#X connect 19 0 11 0;
#X connect 20 0 21 0;
#X connect 21 0 42 0;
#X connect 24 0 16 0;
#X connect 25 0 37 0;
#X connect 26 0 39 0;
#X connect 26 1 29 0;
#X connect 27 0 28 0;
#X connect 27 0 43 0;
#X connect 28 0 27 1;
#X connect 29 0 27 1;
#X connect 30 0 33 0;
#X connect 30 1 31 0;
#X connect 31 0 32 0;
#X connect 32 0 33 1;
#X connect 32 1 34 0;
#X connect 33 0 26 0;
#X connect 34 0 35 0;
#X connect 35 0 42 0;
#X connect 36 0 27 0;
#X connect 37 0 24 1;
#X connect 37 1 1 1;
#X connect 38 1 15 0;
#X connect 39 1 36 0;
#X connect 40 0 41 0;
#X connect 41 0 44 0;
#X connect 41 1 45 0;
#X connect 42 0 3 0;
#X connect 43 0 2 0;
#X connect 44 0 43 1;
#X connect 44 1 42 1;
#X connect 45 0 46 0;
#X connect 46 0 3 0;
#X connect 48 0 10 0;
#X restore 37 151 pd \$0-scale_output;
#N canvas 147 629 289 156 \$0-tables 0;
#X obj 20 10 table \$0-freq_wave 512;
#X obj 20 30 table \$0-frequencies;
#X obj 20 70 table \$0-amplitudes;
#X obj 20 91 table \$0-midi_amps;
#X obj 20 50 table \$0-amp_wave 512;
#X restore 282 292 pd \$0-tables;
#N canvas 60 98 732 566 \$0-write_amp_values 0;
#X obj 42 444 f;
#X msg 60 422 0;
#X obj 61 185 samplerate~;
#X obj 17 224 swap;
#X obj 17 246 /;
#X obj 72 444 +;
#X obj 17 311 /;
#X obj 17 202 f;
#X obj 17 78 t b b;
#X text 140 71 write the incoming signal to a table;
#X text 56 237 then calculate how many sample one period takes;
#X obj 42 398 t b f;
#X obj 17 355 f;
#X obj 17 333 t b f b;
#X obj 61 162 loadbang;
#X text 76 307 and calculate index jump according the the number of
voices \, to read and store values from the stored signal \, to the
amplitudes table;
#X obj 17 117 del;
#X obj 61 207 t f f;
#X obj 253 178 /;
#X obj 253 200 * 1000;
#X text 305 175 set array's size in ms to delay the rest of the process
after we store a wave to the table;
#X obj 89 95 tabwrite~ \$0-amp_wave;
#X obj 253 156 array size \$0-amp_wave;
#X obj 17 10 r \$0-new_amp;
#X obj 35 268 r \$0-num_voices;
#X obj 42 466 tabread \$0-amp_wave;
#X obj 42 492 tabwrite \$0-amplitudes;
#X obj 89 68 r~;
#X obj 89 46 r \$0-7th_input;
#X obj 17 377 loop;
#X obj 35 290 t f f;
#X obj 17 516 s \$0-set_new_amp;
#X obj 253 133 t b f;
#N canvas 484 62 668 564 \$0-set_amp_r 0;
#X obj 197 81 loadbang;
#X obj 197 125 \$3;
#X obj 197 147 +;
#X obj 229 125 \$2;
#X msg 95 401 obj 200 100 r \$1-incoming_amp_freq;
#X obj 111 277 r \$0-amp_freq_through;
#X obj 111 321 outlet;
#X msg 115 376 clear;
#X msg 55 453 connect 0 0 1 0;
#X obj 15 94 r to_mtx_mul;
#X obj 15 116 list split 1;
#X obj 55 139 unpack f f f;
#X obj 55 164 ==;
#X obj 197 103 t b b;
#X obj 55 279 &&;
#X obj 55 324 f;
#X obj 55 302 sel 1;
#X obj 111 299 spigot;
#X obj 136 176 t f f;
#X obj 55 186 t f f;
#X obj 150 248 spigot;
#X obj 150 225 f;
#X obj 150 203 t b f;
#X obj 55 347 t b b f b;
#X text 26 11 we're dynamically creating the [receive] according to
the connection state of this outlet to receive the frequency of the
signal coming in the amplitude inlet;
#X text 195 202 if a connection with this outlet occurs \, use its
state to determine whether the value will pass or not;
#X obj 75 372 \$0;
#X msg 75 428 obj 200 150 s \$1-amp_freq_through;
#X obj 55 479 s pd-\$0-create_amp_r_and_s;
#N canvas 0 51 450 300 \$0-create_amp_r_and_s 0;
#X obj 200 100 r 2-incoming_amp_freq;
#X obj 200 150 s 1441-amp_freq_through;
#X connect 0 0 1 0;
#X restore 55 502 pd \$0-create_amp_r_and_s;
#X connect 0 0 13 0;
#X connect 1 0 2 0;
#X connect 2 0 12 1;
#X connect 3 0 2 1;
#X connect 4 0 28 0;
#X connect 5 0 17 0;
#X connect 7 0 28 0;
#X connect 8 0 28 0;
#X connect 9 0 10 0;
#X connect 10 1 11 0;
#X connect 11 0 12 0;
#X connect 11 1 15 1;
#X connect 11 2 18 0;
#X connect 12 0 19 0;
#X connect 13 0 1 0;
#X connect 13 1 3 0;
#X connect 14 0 16 0;
#X connect 15 0 23 0;
#X connect 16 0 15 0;
#X connect 17 0 6 0;
#X connect 18 0 14 1;
#X connect 18 1 21 1;
#X connect 19 0 14 0;
#X connect 19 1 22 0;
#X connect 20 0 17 1;
#X connect 21 0 20 0;
#X connect 22 0 21 0;
#X connect 22 1 20 1;
#X connect 23 0 8 0;
#X connect 23 1 26 0;
#X connect 23 2 4 0;
#X connect 23 3 7 0;
#X connect 26 0 27 0;
#X connect 27 0 28 0;
#X restore 35 138 pd \$0-set_amp_r;
#X connect 0 0 5 0;
#X connect 0 0 25 0;
#X connect 1 0 0 1;
#X connect 2 0 17 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 6 0;
#X connect 5 0 0 1;
#X connect 6 0 13 0;
#X connect 7 0 3 0;
#X connect 8 0 16 0;
#X connect 8 1 21 0;
#X connect 11 0 0 0;
#X connect 11 1 26 1;
#X connect 12 0 29 0;
#X connect 13 0 12 0;
#X connect 13 1 5 1;
#X connect 13 2 1 0;
#X connect 14 0 2 0;
#X connect 16 0 7 0;
#X connect 17 0 3 1;
#X connect 17 1 32 0;
#X connect 18 0 19 0;
#X connect 19 0 16 1;
#X connect 22 0 18 0;
#X connect 23 0 8 0;
#X connect 24 0 30 0;
#X connect 25 0 26 0;
#X connect 27 0 21 0;
#X connect 28 0 27 0;
#X connect 29 0 31 0;
#X connect 29 1 11 0;
#X connect 30 0 6 1;
#X connect 30 1 12 1;
#X connect 32 0 22 0;
#X connect 32 1 18 1;
#X connect 33 0 7 1;
#X restore 282 270 pd \$0-write_amp_values;
#N canvas 441 129 740 566 \$0-write_freq_values 0;
#X obj 52 442 f;
#X msg 70 420 0;
#X obj 71 183 samplerate~;
#X obj 27 222 swap;
#X obj 27 244 /;
#X obj 82 442 +;
#X obj 27 309 /;
#X obj 27 200 f;
#X obj 27 76 t b b;
#X text 150 69 write the incoming signal to a table;
#X text 66 235 then calculate how many sample one period takes;
#X obj 52 396 t b f;
#X obj 27 353 f;
#X obj 27 331 t b f b;
#X obj 265 176 /;
#X obj 265 198 * 1000;
#X text 317 173 set array's size in ms to delay the rest of the process
after we store a wave to the table;
#X obj 27 111 del;
#X obj 71 160 loadbang;
#X obj 71 205 t f f;
#X text 86 305 and calculate index jump according the the number of
voices \, to read and store values of a full period from the stored
signal \, to the frequencies table;
#X obj 99 93 tabwrite~ \$0-freq_wave;
#X obj 265 154 array size \$0-freq_wave;
#X obj 52 464 tabread \$0-freq_wave;
#X obj 52 490 tabwrite \$0-frequencies;
#X obj 27 18 r \$0-new_freq;
#X obj 45 266 r \$0-num_voices;
#X obj 99 66 r~;
#X obj 99 43 r \$0-1st_input;
#X obj 265 132 t b f;
#X obj 27 375 loop;
#X obj 45 288 t f f;
#X obj 27 514 s \$0-set_new_freq;
#N canvas 385 51 634 547 \$0-set_freq_r 0;
#X obj 197 72 loadbang;
#X obj 197 95 \$3;
#X obj 111 291 outlet;
#X msg 115 369 clear;
#X msg 55 446 connect 0 0 1 0;
#X obj 15 64 r to_mtx_mul;
#X obj 15 86 list split 1;
#X obj 55 109 unpack f f f;
#X obj 55 134 ==;
#X obj 55 249 &&;
#X obj 55 294 f;
#X obj 55 272 sel 1;
#X obj 111 269 spigot;
#X obj 136 146 t f f;
#X obj 55 156 t f f;
#X obj 150 218 spigot;
#X obj 150 195 f;
#X obj 150 173 t b f;
#X obj 55 340 t b b f b;
#X text 195 172 if a connection with this outlet occurs \, use its
state to determine whether the value will pass or not;
#X obj 75 365 \$0;
#X obj 197 117 + 1;
#X text 26 11 we're dynamically creating the [receive] according to
the connection state of this outlet to receive the frequency of the
signal coming in the frequency inlet;
#X msg 75 421 obj 200 150 s \$1-freq_through;
#X msg 95 394 obj 200 100 r \$1-incoming_freq;
#X obj 55 472 s pd-\$0-create_freq_r_and_s;
#N canvas 0 51 450 300 \$0-create_freq_r_and_s 0;
#X obj 200 100 r 2-incoming_freq;
#X obj 200 150 s 1441-freq_through;
#X connect 0 0 1 0;
#X restore 55 495 pd \$0-create_freq_r_and_s;
#X obj 111 247 r \$0-freq_through;
#N canvas 606 99 594 626 check_if_is_oscillator 0;
#X obj 30 82 v num_of_modules;
#X obj 30 104 loop;
#X obj 30 11 inlet;
#X obj 70 55 - 1;
#X text 99 55 subtract one cause we're counting from 0;
#X obj 55 148 tabread all_outlets_tab;
#X obj 55 170 ==;
#X obj 55 192 sel 1;
#X obj 55 214 t b b;
#X obj 55 236 f;
#X obj 55 126 t f f;
#X obj 55 281 tabread is_osc;
#X obj 55 258 t f f;
#X obj 55 303 sel 1 0;
#X obj 55 325 f;
#X obj 186 362 tabread all_inlets_tab;
#X obj 186 339 f;
#X obj 186 430 v inlets;
#X obj 186 452 loop;
#X obj 211 519 pack;
#X msg 211 541 element \$2 \$1;
#X obj 55 371 outlet;
#X obj 211 563 s get_element;
#X obj 212 221 r give_element;
#X obj 212 267 spigot;
#X obj 212 289 sel 1;
#X obj 211 496 t f f;
#X obj 212 311 t b b;
#X obj 186 407 t b f f;
#X msg 286 250 0;
#X msg 251 243 1;
#X obj 30 33 t b f f b;
#X obj 55 347 t f b;
#X obj 186 384 + 1;
#X text 214 384 [mtx] counts from 1 but we count from 0;
#X obj 211 474 + 1;
#X connect 0 0 1 0;
#X connect 1 1 10 0;
#X connect 2 0 31 0;
#X connect 3 0 6 1;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 8 1 1 3;
#X connect 9 0 12 0;
#X connect 10 0 5 0;
#X connect 10 1 9 1;
#X connect 11 0 13 0;
#X connect 12 0 11 0;
#X connect 12 1 16 1;
#X connect 13 0 14 0;
#X connect 13 1 16 0;
#X connect 14 0 32 0;
#X connect 15 0 33 0;
#X connect 16 0 15 0;
#X connect 17 0 18 0;
#X connect 18 1 35 0;
#X connect 19 0 20 0;
#X connect 20 0 22 0;
#X connect 23 0 24 0;
#X connect 24 0 25 0;
#X connect 25 0 27 0;
#X connect 26 0 19 0;
#X connect 26 1 9 1;
#X connect 27 0 9 0;
#X connect 27 1 18 3;
#X connect 28 0 17 0;
#X connect 28 1 19 1;
#X connect 28 2 14 1;
#X connect 29 0 24 1;
#X connect 30 0 24 1;
#X connect 31 0 0 0;
#X connect 31 1 14 1;
#X connect 31 2 3 0;
#X connect 31 3 30 0;
#X connect 32 0 21 0;
#X connect 32 1 29 0;
#X connect 33 0 28 0;
#X connect 35 0 26 0;
#X restore 55 317 pd check_if_is_oscillator;
#X connect 0 0 1 0;
#X connect 1 0 21 0;
#X connect 3 0 25 0;
#X connect 4 0 25 0;
#X connect 5 0 6 0;
#X connect 6 1 7 0;
#X connect 7 0 8 0;
#X connect 7 1 10 1;
#X connect 7 2 13 0;
#X connect 8 0 14 0;
#X connect 9 0 11 0;
#X connect 10 0 28 0;
#X connect 11 0 10 0;
#X connect 12 0 2 0;
#X connect 13 0 9 1;
#X connect 13 1 16 1;
#X connect 14 0 9 0;
#X connect 14 1 17 0;
#X connect 15 0 12 1;
#X connect 16 0 15 0;
#X connect 17 0 16 0;
#X connect 17 1 15 1;
#X connect 18 0 4 0;
#X connect 18 1 20 0;
#X connect 18 2 24 0;
#X connect 18 3 3 0;
#X connect 20 0 23 0;
#X connect 21 0 8 1;
#X connect 23 0 25 0;
#X connect 24 0 25 0;
#X connect 27 0 12 0;
#X connect 28 0 18 0;
#X restore 45 135 pd \$0-set_freq_r;
#X connect 0 0 5 0;
#X connect 0 0 23 0;
#X connect 1 0 0 1;
#X connect 2 0 19 0;
#X connect 3 0 4 0;
#X connect 3 1 4 1;
#X connect 4 0 6 0;
#X connect 5 0 0 1;
#X connect 6 0 13 0;
#X connect 7 0 3 0;
#X connect 8 0 17 0;
#X connect 8 1 21 0;
#X connect 11 0 0 0;
#X connect 11 1 24 1;
#X connect 12 0 30 0;
#X connect 13 0 12 0;
#X connect 13 1 5 1;
#X connect 13 2 1 0;
#X connect 14 0 15 0;
#X connect 15 0 17 1;
#X connect 17 0 7 0;
#X connect 18 0 2 0;
#X connect 19 0 3 1;
#X connect 19 1 29 0;
#X connect 22 0 14 0;
#X connect 23 0 24 0;
#X connect 25 0 8 0;
#X connect 26 0 31 0;
#X connect 27 0 21 0;
#X connect 28 0 27 0;
#X connect 29 0 22 0;
#X connect 29 1 14 1;
#X connect 30 0 32 0;
#X connect 30 1 11 0;
#X connect 31 0 6 1;
#X connect 31 1 12 1;
#X connect 33 0 7 1;
#X restore 282 247 pd \$0-write_freq_values;
#N canvas 697 223 321 182 \$0-collect-midi-amps 0;
#X obj 36 27 r midi-amps;
#X obj 36 73 spigot;
#X obj 36 95 unpack;
#X obj 36 127 tabwrite \$0-midi_amps;
#X obj 75 51 r \$0-midi_connect;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 4 0 1 1;
#X restore 282 224 pd \$0-collect-midi-amps;
#N canvas 632 137 527 458 \$0-scale-offset 0;
#X obj 36 61 change;
#X obj 36 273 + 1;
#X obj 36 297 swap 1;
#X obj 36 319 /;
#X obj 36 341 t f f;
#X obj 54 222 loadbang;
#X msg 54 244 0;
#X obj 36 385 outlet;
#X obj 68 364 outlet;
#X obj 36 86 swap;
#X obj 36 108 pack;
#X obj 36 130 route 1 0;
#X obj 36 197 f;
#X text 65 184 when the patching update is deactivated \, store value
and output it when it is reactivated;
#X obj 221 69 r patchUpdate;
#X obj 109 130 r reactivate;
#X obj 36 39 inlet;
#X connect 0 0 9 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 3 0 4 0;
#X connect 4 0 7 0;
#X connect 4 1 8 0;
#X connect 5 0 6 0;
#X connect 6 0 1 0;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 1 0;
#X connect 14 0 9 1;
#X connect 15 0 12 0;
#X connect 16 0 0 0;
#X restore 65 204 pd \$0-scale-offset;
#N canvas 508 270 396 270 \$0-initialize_instances 0;
#X obj 17 14 loadbang;
#X msg 17 61 1;
#N canvas 209 277 450 300 \$0-instances 0;
#X obj 30 30 var_shapes_instance 1280 0;
#X restore 17 220 pd \$0-instances;
#X msg 177 102 clear;
#X text 43 61 create one instance of this module by default;
#X obj 40 176 outlet;
#X obj 17 198 outlet;
#X obj 233 109 r \$0-1st_inlet;
#X obj 233 131 sel 0;
#N canvas 52 286 505 456 \$0-instance_creation_loop 0;
#X obj 89 162 t f f;
#X obj 89 184 * 30;
#X obj 89 206 + 30;
#X obj 156 204 \$0;
#X obj 89 228 pack f f f;
#X msg 89 251 obj 30 \$1 var_shapes_instance \$3 \$2 \, loadbang;
#X obj 64 118 loop;
#X obj 89 140 +;
#X obj 25 42 inlet;
#X obj 64 404 outlet done;
#X obj 274 130 inlet clear;
#X obj 89 273 outlet to_instance_subpatch;
#X obj 163 324 f;
#X obj 163 346 s \$0-is_midi;
#X obj 181 302 r \$0-def_midi_con;
#X obj 105 336 > 1;
#X obj 64 307 t b b b;
#X obj 87 381 s \$0-is_poly;
#X obj 87 358 f;
#X obj 18 73 t f b;
#X obj 18 119 t b;
#X text 76 83 0 won't cause a loop \, so we need to bang the \$0-is_poly
explicitly;
#X obj 18 95 moses 1;
#N canvas 81 94 645 410 \$0-set_num_voices 0;
#X obj 31 25 r \$0-num_voices;
#X obj 105 78 1;
#X obj 31 242 spigot;
#X obj 31 318 outlet to_loop;
#X obj 49 139 t f f;
#X obj 319 211 spigot;
#X obj 358 156 == 0;
#X obj 319 279 outlet to_clear;
#X obj 31 219 -;
#X text 79 244 create only additional instances;
#X obj 49 117 >=;
#X obj 105 100 t f f f f;
#X obj 145 267 outlet to_offset;
#X obj 31 47 t f f f f b;
#X obj 68 292 outlet to_is_midi;
#X text 77 118 check if new number of voices is greater than previous
one;
#X text 33 336 if we're creating more instances \, send additional
number to [loop];
#X obj 354 39 inlet reset;
#X msg 354 61 1;
#X obj 319 235 abs;
#X obj 319 257 pack;
#X text 353 253 or delete only additional instances;
#X obj 31 194 t f f;
#X connect 0 0 13 0;
#X connect 1 0 11 0;
#X connect 2 0 3 0;
#X connect 4 0 2 1;
#X connect 4 1 6 0;
#X connect 5 0 19 0;
#X connect 6 0 5 1;
#X connect 8 0 2 0;
#X connect 10 0 4 0;
#X connect 11 0 10 1;
#X connect 11 1 8 1;
#X connect 11 2 12 0;
#X connect 11 3 20 1;
#X connect 13 0 22 0;
#X connect 13 1 10 0;
#X connect 13 2 14 0;
#X connect 13 3 1 1;
#X connect 13 4 1 0;
#X connect 17 0 18 0;
#X connect 18 0 1 1;
#X connect 19 0 20 0;
#X connect 20 0 7 0;
#X connect 22 0 8 0;
#X connect 22 1 5 0;
#X restore 18 18 pd \$0-set_num_voices;
#N canvas 560 389 337 291 \$0-clear_additional 0;
#X obj 16 17 inlet;
#X obj 48 246 outlet;
#X obj 96 17 inlet clear_all_but_first;
#X obj 16 39 unpack;
#X obj 16 201 loop, f 5;
#X msg 48 223 delete \$1;
#X obj 114 41 r \$0-max_voice_num;
#X obj 96 86 f;
#X msg 142 131 1;
#X obj 16 61 swap;
#X obj 16 83 + 1;
#X obj 16 105 t b f;
#X obj 96 108 t b f b;
#X obj 114 63 - 1;
#X connect 0 0 3 0;
#X connect 2 0 7 0;
#X connect 3 0 9 0;
#X connect 3 1 9 1;
#X connect 4 1 5 0;
#X connect 5 0 1 0;
#X connect 6 0 13 0;
#X connect 7 0 12 0;
#X connect 8 0 4 2;
#X connect 9 0 10 0;
#X connect 9 1 4 2;
#X connect 10 0 11 0;
#X connect 11 0 4 0;
#X connect 11 1 4 1;
#X connect 12 0 4 0;
#X connect 12 1 4 1;
#X connect 12 2 8 0;
#X connect 13 0 7 1;
#X restore 155 174 pd \$0-clear_additional;
#X obj 274 152 t b b;
#X connect 0 0 1 0;
#X connect 0 1 4 1;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 4 2;
#X connect 4 0 5 0;
#X connect 5 0 11 0;
#X connect 6 0 16 0;
#X connect 6 1 7 0;
#X connect 7 0 0 0;
#X connect 8 0 19 0;
#X connect 10 0 25 0;
#X connect 12 0 13 0;
#X connect 14 0 12 1;
#X connect 15 0 18 1;
#X connect 16 0 9 0;
#X connect 16 1 18 0;
#X connect 16 2 12 0;
#X connect 18 0 17 0;
#X connect 19 0 22 0;
#X connect 19 1 3 0;
#X connect 20 0 18 0;
#X connect 22 0 20 0;
#X connect 22 1 6 0;
#X connect 23 0 19 0;
#X connect 23 1 15 0;
#X connect 23 2 7 1;
#X connect 23 3 24 0;
#X connect 24 0 11 0;
#X connect 25 0 23 0;
#X connect 25 1 24 1;
#X restore 40 153 pd \$0-instance_creation_loop;
#X obj 17 85 t b f b;
#X obj 233 176 s pd-\$0-instances;
#X obj 17 36 del 100;
#X connect 0 0 12 0;
#X connect 1 0 10 0;
#X connect 3 0 11 0;
#X connect 7 0 8 0;
#X connect 8 0 9 1;
#X connect 9 0 5 0;
#X connect 9 1 11 0;
#X connect 10 0 6 0;
#X connect 10 1 9 0;
#X connect 10 2 3 0;
#X connect 12 0 1 0;
#X restore 19 71 pd \$0-initialize_instances;
#N canvas 364 55 815 624 \$0-names_states_and_tab_init 0;
#X obj 27 293 s \$0-1st_input;
#X obj 45 273 s \$0-2nd_input;
#X obj 64 253 s \$0-3rd_input;
#X obj 82 233 s \$0-4th_input;
#X obj 101 213 s \$0-5th_input;
#X obj 119 193 s \$0-6th_input;
#X obj 27 346 r inlet_states;
#X obj 27 368 unpack;
#X obj 27 412 pack;
#X text 148 126 this sets the correct names to each [r~ ];
#X text 26 315 this sets the connection state of the modules inlets
(the matrix's outlets);
#X obj 307 448 unpack;
#X obj 307 492 pack;
#X obj 307 536 s \$0-1st_outlet;
#X text 306 395 this sets the connection state of the modules outlets
(the matrix's inlets);
#X obj 307 426 r outlet_states;
#X obj 27 126 set_inputs \$2 \$3;
#X obj 27 390 - \$3;
#X obj 307 470 - \$5;
#X obj 307 514 route 1;
#X obj 27 19 inlet;
#X obj 138 173 s \$0-7th_input;
#X obj 27 434 route 1 2 3 4 5 6 7;
#X obj 27 149 route 0 1 2 3 4 5 6;
#X obj 509 146 array size \$0-frequencies;
#X obj 532 124 array size \$0-amplitudes;
#X msg 509 58 1;
#X obj 509 80 t f f f;
#X obj 555 102 array size \$0-midi_amps;
#N canvas 387 154 305 249 \$0-inlet1 0;
#X obj 49 50 inlet;
#X obj 86 75 r reactivate;
#X obj 123 100 r patchUpdate;
#X obj 49 204 s \$0-1st_inlet;
#X obj 49 122 inlet_state;
#X obj 138 123 r \$0-reinit;
#X obj 73 159 r \$0-init;
#X connect 0 0 4 0;
#X connect 1 0 4 1;
#X connect 2 0 4 2;
#X connect 4 0 3 0;
#X connect 5 0 4 1;
#X connect 6 0 3 0;
#X restore 27 578 pd \$0-inlet1;
#N canvas 0 51 297 238 \$0-inlet2 0;
#X obj 31 29 inlet;
#X obj 68 54 r reactivate;
#X obj 105 79 r patchUpdate;
#X obj 31 183 s \$0-2nd_inlet;
#X obj 31 101 inlet_state;
#X obj 119 102 r \$0-reinit;
#X obj 52 144 r \$0-init;
#X connect 0 0 4 0;
#X connect 1 0 4 1;
#X connect 2 0 4 2;
#X connect 4 0 3 0;
#X connect 5 0 4 1;
#X connect 6 0 3 0;
#X restore 45 558 pd \$0-inlet2;
#N canvas 0 51 306 234 \$0-inlet3 0;
#X obj 54 27 inlet;
#X obj 91 52 r reactivate;
#X obj 128 77 r patchUpdate;
#X obj 54 181 s \$0-3rd_inlet;
#X obj 54 99 inlet_state;
#X obj 141 99 r \$0-reinit;
#X obj 76 138 r \$0-init;
#X connect 0 0 4 0;
#X connect 1 0 4 1;
#X connect 2 0 4 2;
#X connect 4 0 3 0;
#X connect 5 0 4 1;
#X connect 6 0 3 0;
#X restore 64 538 pd \$0-inlet3;
#N canvas 0 51 299 229 \$0-inlet4 0;
#X obj 32 31 inlet;
#X obj 69 56 r reactivate;
#X obj 106 81 r patchUpdate;
#X obj 32 185 s \$0-4th_inlet;
#X obj 32 103 inlet_state;
#X obj 48 155 r \$0-init;
#X obj 120 104 r \$0-reinit;
#X connect 0 0 4 0;
#X connect 1 0 4 1;
#X connect 2 0 4 2;
#X connect 4 0 3 0;
#X connect 5 0 3 0;
#X connect 6 0 4 1;
#X restore 82 518 pd \$0-inlet4;
#N canvas 0 51 299 225 \$0-inlet5 0;
#X obj 30 22 inlet;
#X obj 67 47 r reactivate;
#X obj 104 72 r patchUpdate;
#X obj 30 176 s \$0-5th_inlet;
#X obj 30 94 inlet_state;
#X obj 47 140 r \$0-init;
#X obj 118 95 r \$0-reinit;
#X connect 0 0 4 0;
#X connect 1 0 4 1;
#X connect 2 0 4 2;
#X connect 4 0 3 0;
#X connect 5 0 3 0;
#X connect 6 0 4 1;
#X restore 101 498 pd \$0-inlet5;
#N canvas 0 51 335 229 \$0-inlet6 0;
#X obj 30 21 inlet;
#X obj 67 46 r reactivate;
#X obj 104 71 r patchUpdate;
#X obj 30 175 s \$0-6th_inlet;
#X obj 30 93 inlet_state;
#X obj 49 141 r \$0-init;
#X obj 116 93 r \$0-reinit;
#X connect 0 0 4 0;
#X connect 1 0 4 1;
#X connect 2 0 4 2;
#X connect 4 0 3 0;
#X connect 5 0 3 0;
#X connect 6 0 4 1;
#X restore 119 478 pd \$0-inlet6;
#N canvas 421 402 310 232 \$0-inlet7 0;
#X obj 19 31 inlet;
#X obj 19 103 inlet_state;
#X obj 56 56 r reactivate;
#X obj 93 81 r patchUpdate;
#X obj 19 185 s \$0-7th_inlet;
#X obj 37 148 r \$0-init;
#X obj 106 103 r \$0-reinit;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 2 0 1 1;
#X connect 3 0 1 2;
#X connect 5 0 4 0;
#X connect 6 0 1 1;
#X restore 138 458 pd \$0-inlet7;
#X obj 27 41 t b b b;
#X msg 50 64 0;
#X obj 50 86 s \$0-init;
#X text 120 86 goes into [pd \$0-inlet] subpatches below;
#X obj 331 224 t b b;
#X obj 363 246 s \$0-reinit;
#X text 448 248 goes into [pd \$0-inlet] subpatches below;
#X obj 331 202 inlet from_loop;
#X connect 6 0 7 0;
#X connect 7 0 17 0;
#X connect 7 1 8 1;
#X connect 8 0 22 0;
#X connect 11 0 18 0;
#X connect 11 1 12 1;
#X connect 12 0 19 0;
#X connect 15 0 11 0;
#X connect 16 0 23 0;
#X connect 17 0 8 0;
#X connect 18 0 12 0;
#X connect 19 0 13 0;
#X connect 20 0 36 0;
#X connect 22 0 29 0;
#X connect 22 1 30 0;
#X connect 22 2 31 0;
#X connect 22 3 32 0;
#X connect 22 4 33 0;
#X connect 22 5 34 0;
#X connect 22 6 35 0;
#X connect 23 0 0 0;
#X connect 23 1 1 0;
#X connect 23 2 2 0;
#X connect 23 3 3 0;
#X connect 23 4 4 0;
#X connect 23 5 5 0;
#X connect 23 6 21 0;
#X connect 26 0 27 0;
#X connect 27 0 24 0;
#X connect 27 1 25 0;
#X connect 27 2 28 0;
#X connect 36 0 16 0;
#X connect 36 1 37 0;
#X connect 36 2 26 0;
#X connect 37 0 38 0;
#X connect 40 0 16 0;
#X connect 40 1 41 0;
#X connect 43 0 40 0;
#X restore 19 93 pd \$0-names_states_and_tab_init;
#N canvas 160 51 389 719 \$0-assemble_and_scale_values 0;
#X obj 7 130 +;
#X obj 24 109 * 128;
#X obj 42 80 +;
#X obj 59 59 * 128;
#X obj 77 130 +;
#X obj 94 109 * 128;
#X obj 112 80 +;
#X obj 129 59 * 128;
#X obj 147 130 +;
#X obj 164 109 * 128;
#X obj 182 80 +;
#X obj 199 59 * 128;
#X obj 217 144 +;
#X obj 234 123 * 128;
#X obj 77 423 / 8191;
#X obj 77 445 * 2;
#X obj 112 381 / 8191;
#X obj 147 339 / 8191;
#X obj 182 253 / 8191;
#X obj 182 275 pow 4;
#X obj 182 297 * 1000;
#X obj 217 167 / 8191;
#X obj 217 189 pow 4;
#X obj 217 211 * 1000;
#X obj 42 597 + 1;
#X obj 77 467 s \$0-2nd_knob;
#X obj 7 680 s \$0-1st_knob;
#X obj 112 403 s \$0-3rd_knob;
#X obj 147 361 s \$0-4th_knob;
#X obj 182 319 s \$0-5th_knob;
#X obj 217 233 s \$0-6th_knob;
#X obj 7 26 unpack f f f f f f f f f f f f f f f f;
#X obj 252 81 +;
#X obj 270 59 * 128;
#X obj 252 103 s \$0-ramp_time;
#X obj 7 3 r module\$1;
#X obj 7 156 t f f;
#X obj 7 636 t f f;
#N canvas 258 60 529 501 \$0-num_of_voices 0;
#X obj 101 230 / 8191;
#X obj 101 294 i;
#X obj 101 315 change;
#X obj 101 450 array size \$0-frequencies;
#X obj 121 429 array size \$0-amplitudes;
#X obj 161 387 s \$0-num_voices;
#X obj 101 272 + 1;
#X obj 141 408 array size \$0-midi_amps;
#X obj 101 366 t f f f f;
#X obj 197 145 r \$0-1st_inlet;
#X obj 22 54 r \$0-midi_connect;
#X obj 172 190 >>;
#X obj 101 185 inlet;
#X obj 101 207 spigot;
#X text 20 8 if a signal connects to the frequency inlet \, but that's
not the midi module \, then and only then use the first knob to set
the number of voices;
#X obj 40 145 r num_of_midi_voices;
#X obj 22 169 f;
#X obj 172 167 swap;
#X obj 22 76 t f f f;
#X obj 68 97 s \$0-def_midi_con;
#X obj 22 121 sel 1;
#X obj 245 168 loadbang;
#X msg 245 190 10;
#X obj 245 234 - 1;
#X obj 277 234 s \$0-max_voice_num;
#X obj 245 212 t f f;
#X text 276 188 set maximum number of instances;
#X obj 101 251 *;
#X connect 0 0 27 0;
#X connect 1 0 2 0;
#X connect 2 0 8 0;
#X connect 6 0 1 0;
#X connect 8 0 3 0;
#X connect 8 1 4 0;
#X connect 8 2 7 0;
#X connect 8 3 5 0;
#X connect 9 0 17 1;
#X connect 10 0 18 0;
#X connect 11 0 13 1;
#X connect 12 0 13 0;
#X connect 13 0 0 0;
#X connect 15 0 16 1;
#X connect 16 0 8 0;
#X connect 17 0 11 0;
#X connect 17 1 11 1;
#X connect 18 0 20 0;
#X connect 18 1 17 0;
#X connect 18 2 19 0;
#X connect 20 0 16 0;
#X connect 21 0 22 0;
#X connect 22 0 25 0;
#X connect 23 0 27 1;
#X connect 25 0 23 0;
#X connect 25 1 24 0;
#X connect 27 0 6 0;
#X restore 39 179 pd \$0-num_of_voices;
#X obj 42 488 / 8191;
#X obj 42 510 t f f;
#X obj 42 532 *;
#X obj 42 554 * 4095;
#X obj 7 614 / 1;
#X obj 42 575 debounce_float;
#N canvas 72 353 533 283 \$0-other_values 0;
#X obj 22 211 s;
#X obj 22 34 inlet;
#X obj 22 56 t f f;
#X obj 229 191 s;
#X obj 40 86 loadbang;
#X obj 40 108 \$5;
#X obj 40 130 + 1;
#X msg 247 169 symbol \$1-incoming_amp_freq;
#X obj 40 152 t f f;
#X text 84 19 fixed names of [send]s according to the matrix inlet
number;
#X msg 40 187 symbol \$1-incoming_freq;
#X obj 217 64 r \$1-get_inlet;
#X obj 217 86 \$3;
#X obj 217 108 s give_inlet;
#X obj 327 64 r \$1-get_outlet;
#X obj 327 108 s give_outlet;
#X obj 327 86 \$5;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 2 1 3 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 8 0;
#X connect 7 0 3 1;
#X connect 8 0 10 0;
#X connect 8 1 7 0;
#X connect 10 0 0 1;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 14 0 16 0;
#X connect 16 0 15 0;
#X restore 39 658 pd \$0-other_values;
#X connect 0 0 36 0;
#X connect 1 0 0 1;
#X connect 2 0 39 0;
#X connect 3 0 2 1;
#X connect 4 0 14 0;
#X connect 5 0 4 1;
#X connect 6 0 16 0;
#X connect 7 0 6 1;
#X connect 8 0 17 0;
#X connect 9 0 8 1;
#X connect 10 0 18 0;
#X connect 11 0 10 1;
#X connect 12 0 21 0;
#X connect 13 0 12 1;
#X connect 14 0 15 0;
#X connect 15 0 25 0;
#X connect 16 0 27 0;
#X connect 17 0 28 0;
#X connect 18 0 19 0;
#X connect 19 0 20 0;
#X connect 20 0 29 0;
#X connect 21 0 22 0;
#X connect 22 0 23 0;
#X connect 23 0 30 0;
#X connect 24 0 43 1;
#X connect 31 0 0 0;
#X connect 31 1 1 0;
#X connect 31 2 2 0;
#X connect 31 3 3 0;
#X connect 31 4 4 0;
#X connect 31 5 5 0;
#X connect 31 6 6 0;
#X connect 31 7 7 0;
#X connect 31 8 8 0;
#X connect 31 9 9 0;
#X connect 31 10 10 0;
#X connect 31 11 11 0;
#X connect 31 12 12 0;
#X connect 31 13 13 0;
#X connect 31 14 32 0;
#X connect 31 15 33 0;
#X connect 32 0 34 0;
#X connect 33 0 32 1;
#X connect 35 0 31 0;
#X connect 36 0 43 0;
#X connect 36 1 38 0;
#X connect 37 0 26 0;
#X connect 37 1 45 0;
#X connect 39 0 40 0;
#X connect 40 0 41 0;
#X connect 40 1 41 1;
#X connect 41 0 42 0;
#X connect 42 0 44 0;
#X connect 43 0 37 0;
#X connect 44 0 24 0;
#X restore 19 49 pd \$0-assemble_and_scale_values;
#X obj 282 180 switch_state;
#N canvas 667 78 313 265 \$0-define_midi_connection 0;
#X obj 15 16 r to_mtx_mul;
#X obj 15 38 list split 1;
#X obj 55 60 unpack f f f;
#X obj 55 132 == \$3;
#X obj 95 109 ==;
#X obj 55 154 &&;
#X obj 113 86 r midi_outlet;
#X obj 55 109 - 1;
#X obj 55 199 s \$0-midi_connect;
#X obj 55 177 &&;
#X connect 0 0 1 0;
#X connect 1 1 2 0;
#X connect 2 0 7 0;
#X connect 2 1 4 0;
#X connect 2 2 9 1;
#X connect 3 0 5 0;
#X connect 4 0 5 1;
#X connect 5 0 9 0;
#X connect 6 0 4 1;
#X connect 7 0 3 0;
#X connect 9 0 8 0;
#X restore 282 314 pd \$0-define_midi_connection;
#X obj 282 135 canvasdelete;
#X text 282 117 load [canvasdelete] so we can use [delete \$1(;
#X connect 0 0 1 0;
#X connect 1 0 9 0;
#X connect 2 0 3 0;
#X connect 3 0 0 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 1 1;
#X connect 10 0 9 0;
#X connect 11 0 27 0;
#X connect 12 0 10 0;
#X connect 13 0 14 0;
#X connect 14 0 0 0;
#X connect 17 0 23 0;
#X connect 18 0 14 1;
#X connect 23 0 2 0;
#X connect 23 1 4 0;
#X connect 24 0 25 0;
#X connect 24 1 25 1;
#X connect 27 0 8 0;
